<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 550">
  <defs>
    <style>
      .title { font: bold 20px sans-serif; fill: #333; }
      .label { font: 14px sans-serif; fill: #333; }
      .small-label { font: 12px sans-serif; fill: #666; }
      .box { fill: #e8f5e9; stroke: #388e3c; stroke-width: 2; }
      .server-box { fill: #fff3e0; stroke: #f57c00; stroke-width: 2; }
      .token-box { fill: #fce4ec; stroke: #c2185b; stroke-width: 2; }
      .arrow { stroke: #333; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .return-arrow { stroke: #666; stroke-width: 2; fill: none; marker-end: url(#arrowhead-return); stroke-dasharray: 5,5; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#333" />
    </marker>
    <marker id="arrowhead-return" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#666" />
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="400" y="30" text-anchor="middle" class="title">JWT認証フロー</text>
  
  <!-- Client Box -->
  <rect x="50" y="60" width="150" height="80" class="box" rx="5"/>
  <text x="125" y="90" text-anchor="middle" class="label">クライアント</text>
  <text x="125" y="110" text-anchor="middle" class="small-label">(ブラウザ/</text>
  <text x="125" y="125" text-anchor="middle" class="small-label">モバイルアプリ)</text>
  
  <!-- Server Box -->
  <rect x="325" y="60" width="150" height="80" class="server-box" rx="5"/>
  <text x="400" y="90" text-anchor="middle" class="label">サーバー</text>
  <text x="400" y="110" text-anchor="middle" class="small-label">(認証処理)</text>
  <text x="400" y="125" text-anchor="middle" class="small-label">※ステートレス</text>
  
  <!-- Step 1: Login Request -->
  <path d="M 200 170 L 325 170" class="arrow"/>
  <text x="260" y="160" class="small-label">1. ログイン情報送信</text>
  <text x="260" y="185" class="small-label">(ID/パスワード)</text>
  
  <!-- Step 2: Verify -->
  <rect x="325" y="210" width="150" height="40" class="server-box" rx="5"/>
  <text x="400" y="235" text-anchor="middle" class="small-label">2. 認証情報検証</text>
  
  <!-- Step 3: Generate JWT -->
  <rect x="325" y="270" width="150" height="60" class="token-box" rx="5"/>
  <text x="400" y="290" text-anchor="middle" class="small-label">3. JWT生成</text>
  <text x="400" y="305" text-anchor="middle" class="small-label">Header.Payload</text>
  <text x="400" y="320" text-anchor="middle" class="small-label">.Signature</text>
  
  <!-- Step 4: Return JWT -->
  <path d="M 325 360 L 200 360" class="return-arrow"/>
  <text x="260" y="345" class="small-label">4. JWT返却</text>
  <text x="260" y="375" class="small-label">(JSON形式)</text>
  
  <!-- Step 5: Store JWT -->
  <rect x="50" y="400" width="150" height="40" class="box" rx="5"/>
  <text x="125" y="420" text-anchor="middle" class="small-label">5. JWT保存</text>
  <text x="125" y="433" text-anchor="middle" class="small-label">(localStorage等)</text>
  
  <!-- Subsequent Request Section -->
  <line x1="250" y1="460" x2="550" y2="460" stroke="#999" stroke-width="1" stroke-dasharray="10,5"/>
  <text x="400" y="480" text-anchor="middle" class="label">以降のリクエスト</text>
  
  <!-- Step 6: Request with JWT -->
  <path d="M 200 505 L 325 505" class="arrow"/>
  <text x="260" y="495" class="small-label">6. リクエスト送信</text>
  <text x="260" y="520" class="small-label">(Header: Bearer JWT)</text>
  
  <!-- Step 7: Verify JWT -->
  <rect x="500" y="60" width="250" height="120" class="token-box" rx="5" opacity="0.3"/>
  <text x="625" y="85" text-anchor="middle" class="label">JWT検証プロセス</text>
  <text x="625" y="105" text-anchor="middle" class="small-label">✓ 署名の検証</text>
  <text x="625" y="125" text-anchor="middle" class="small-label">✓ 有効期限の確認</text>
  <text x="625" y="145" text-anchor="middle" class="small-label">✓ ペイロードの解析</text>
  <text x="625" y="165" text-anchor="middle" class="small-label">※DBアクセス不要</text>
  
  <path d="M 400 485 L 400 465" class="arrow"/>
  <text x="520" y="478" class="small-label">7. JWT検証</text>
  
  <!-- Step 8: Return Data -->
  <path d="M 325 535 L 200 535" class="return-arrow"/>
  <text x="260" y="525" class="small-label">8. レスポンス返却</text>
</svg>